(this["webpackJsonpmy-app10"]=this["webpackJsonpmy-app10"]||[]).push([[0],{38:function(e,t,n){},40:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var r,o,i,a,c,s=n(14),l=n(20),p=n(18),u=n(0),d=n.n(u),h=n(7),g=n(62),b=n(43),y=n(27),f=n.n(y),m=(n(49),n(15)),O=n(13),v=n(8),j=n(63),k=n(19),S=n.n(k),_="node",D=(n(38),"uhgj"),I={height:40},x=Object(h.b)("entityLabelStore","dragAndDropStore")(Object(h.c)((function(e){var t=e.entityLabelStore.map.get(e.id),n=Object(j.a)((function(){return{type:_,item:{id:e.id},end:function(){e.dragAndDropStore.endDragging()},collect:function(e){return{isDragging:e.isDragging()}}}})),r=Object(v.a)(n,2),o=r[0].isDragging,i=r[1];Object(u.useEffect)((function(){o&&e.dragAndDropStore.startDragging(e.index)}),[o,e.index]);var a=Object(u.useMemo)((function(){return Object(m.a)(Object(m.a)({},I),{},{marginLeft:40*t.level})}),[t.level]),c=Object(u.useCallback)((function(){e.entityLabelStore.setSelected(e.id)}),[e.id]);return d.a.createElement("div",{className:"NodeBox",style:a,key:e.id,_nk:"".concat(D,"11")},d.a.createElement("button",{type:"button",onClick:c,ref:i,className:S()({Node:!0,Node_selected:e.entityLabelStore.selected.id===e.id}),key:"".concat(D,"21")},t.label))}))),w=(n(50),"HevZ"),L=function(e){var t=e.nestingLevel,n=e.onDragOver,r=e.id,o=e.base,i=Object(u.useState)(!1),a=Object(v.a)(i,2),c=a[0],s=a[1],l=Object(u.useRef)(null),p=Object(u.useMemo)((function(){return{marginLeft:40*t}}),[t]),h=function(){n(r),s(!0)},g=function(){s(!1)},b=function(){return d.a.createElement("div",{ref:o?void 0:l,style:p,className:S()({DropAcceptor__slot:!0,DropAcceptor__slot_active:c}),onDragOver:o?void 0:h,onDragLeave:o?void 0:g,key:"".concat(w,"11")})};return o?d.a.createElement("div",{ref:l,onDragOver:h,onDragLeave:g,key:"".concat(w,"12")},b()):b()},E=-1,A="pBj9",P=Object(h.b)("entityLabelStore","dragAndDropStore")(Object(h.c)((function(e){var t,n=e.entityLabelStore,r=e.dragAndDropStore,o=r.dropAccessorIndex,i=r.isAbleDrop,a=function(e){r.setDropIntention({parentId:e,index:o})},c=n._sequence[o-1],s=null!==(t=n.map.get(c))&&void 0!==t?t:n.map.get(E);return d.a.createElement("div",{key:"".concat(A,"21")},d.a.createElement("div",{className:S()({DropAcceptor:!0,DropAcceptor_invalid:!i}),key:"".concat(A,"22")}),i?function(e,t,n){var r=e.slice(t),o=Math.max(e.length+t,0);return r.map((function(e,t){return d.a.createElement(L,{key:e,id:e,base:0===t,nestingLevel:o+t,onDragOver:n,_nk:"iAr".concat(A,"11")})}))}(s.path,r.availableDropItemIndex,a):null)}))),q=(n(51),function(){return d.a.createElement("div",{className:"DragStart",key:"".concat("7tWz","11")})}),C="RZlH",M="DROP_ACCESSOR_SIGN",N="START_DRAGGING_SIGN",H=function(e,t,n){if(-1===t)return e;var r=Object(O.a)(e);return r.splice(t,0,n),r},T=function(e,t){var n=e<t.from||e>t.to;return-1===e||n?-1:e-t.from},z=function(e,t){return function(e,t,n){var r=n.dropAccessorIndex,o=n.startDraggingIndex,i=T(r,t),a=T(o,t),c=e;return c=H(c,i,M),H(c,a,N)}(e.sequence.slice(e.range.from,e.range.to),e.range,t).map((function(t,n){return t===M?d.a.createElement(P,{key:M,_nk:"".concat(C,"11")}):t===N?d.a.createElement(q,{key:N,_nk:"".concat(C,"21")}):"number"===typeof t?d.a.createElement(x,{key:t,id:t,index:e.range.from+n,_nk:"".concat(C,"31")}):null}))},B=Object(h.b)("dragAndDropStore")(Object(h.c)((function(e){var t={startDraggingIndex:e.dragAndDropStore.startDraggingIndex,dropAccessorIndex:e.dragAndDropStore.dropAccessorIndex};return d.a.createElement(d.a.Fragment,null,z(e,t))}))),R=Object(h.b)("entityLabelStore","virtualScrollStore")(Object(h.c)((function(e){var t=e.entityLabelStore,n=e.virtualScrollStore;return d.a.createElement(B,{sequence:t._sequence,map:t._map,range:n.range,key:"".concat("yky1","11")})}))),G=n(9),F=n(5),U=n(6),J=n(3),V=(n(26),n(1)),Z=(r=function(){function e(t){var n;Object(F.a)(this,e),Object(G.a)(this,"scrollAreaHeight",o,this),Object(G.a)(this,"scrollPosition",i,this),Object(G.a)(this,"itemHeight",a,this),Object(G.a)(this,"itemsTotal",c,this),this.scrollAreaHeight=0,this.itemHeight=null!==(n=t.itemHeight)&&void 0!==n?n:0,this.scrollPosition=0,this.itemsTotal=t.itemsTotal}return Object(U.a)(e,[{key:"setScrollAreaHeight",value:function(e){this.scrollAreaHeight=e}},{key:"setScrollPosition",value:function(e){this.scrollPosition=e}},{key:"setItemHeight",value:function(e){this.itemHeight=e}},{key:"setItemsTotal",value:function(e){this.itemsTotal=e}},{key:"from",get:function(){return Math.floor(this.scrollPosition/this.itemHeight)}},{key:"to",get:function(){var e=this.from+Math.ceil(this.scrollAreaHeight/this.itemHeight)+1;return Math.min(e,this.itemsTotal)}},{key:"range",get:function(){return{from:this.from,to:this.to}}},{key:"contentHeight",get:function(){return this.itemsTotal*this.itemHeight}},{key:"pads",get:function(){var e=this.contentHeight-(this.range.to+1)*this.itemHeight;return{paddingTop:this.range.from*this.itemHeight,paddingBottom:Math.max(0,e)}}}]),e}(),o=Object(J.a)(r.prototype,"scrollAreaHeight",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=Object(J.a)(r.prototype,"scrollPosition",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(J.a)(r.prototype,"itemHeight",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(J.a)(r.prototype,"itemsTotal",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(J.a)(r.prototype,"setScrollAreaHeight",[V.f],Object.getOwnPropertyDescriptor(r.prototype,"setScrollAreaHeight"),r.prototype),Object(J.a)(r.prototype,"setScrollPosition",[V.f],Object.getOwnPropertyDescriptor(r.prototype,"setScrollPosition"),r.prototype),Object(J.a)(r.prototype,"setItemHeight",[V.f],Object.getOwnPropertyDescriptor(r.prototype,"setItemHeight"),r.prototype),Object(J.a)(r.prototype,"setItemsTotal",[V.f],Object.getOwnPropertyDescriptor(r.prototype,"setItemsTotal"),r.prototype),Object(J.a)(r.prototype,"from",[V.g],Object.getOwnPropertyDescriptor(r.prototype,"from"),r.prototype),Object(J.a)(r.prototype,"to",[V.g],Object.getOwnPropertyDescriptor(r.prototype,"to"),r.prototype),Object(J.a)(r.prototype,"range",[V.g],Object.getOwnPropertyDescriptor(r.prototype,"range"),r.prototype),Object(J.a)(r.prototype,"contentHeight",[V.g],Object.getOwnPropertyDescriptor(r.prototype,"contentHeight"),r.prototype),Object(J.a)(r.prototype,"pads",[V.g],Object.getOwnPropertyDescriptor(r.prototype,"pads"),r.prototype),r),W=Object(h.b)("virtualScrollStore")(Object(h.c)((function(e){var t=e.virtualScrollStore,n=Object(u.useRef)(null);Object(u.useEffect)((function(){var e=function(e){var n=e.target.scrollTop;t.setScrollPosition(n)};return n.current&&(n.current.addEventListener("scroll",e),t.setScrollAreaHeight(n.current.offsetHeight)),function(){n.current&&n.current.removeEventListener("scroll",e)}}),[]);var r=e.Container,o=t.pads,i=Object(u.useMemo)((function(){return o}),[o.paddingTop,o.paddingBottom]);return d.a.createElement(r,{style:i,ref:n,key:"".concat("AWf9","11")},e.children({from:t.from,to:t.to}))}))),Q="XNGH",X=function(e){var t=e.children,n=e.options,r=e.Container,o=Object(u.useState)((function(){return function(e){return{virtualScrollStore:new Z(e)}}(n)})),i=Object(v.a)(o,1)[0];return Object(u.useEffect)((function(){i.virtualScrollStore.setItemsTotal(n.itemsTotal)}),[n.itemsTotal]),d.a.createElement(h.a,Object(p.a)({},i,{key:"".concat(Q,"11")}),d.a.createElement(W,{Container:r,key:"".concat(Q,"21")},t))},Y=n(64),K=Object(h.b)("dragAndDropStore")((function(e){var t=e.style,n=e.children,r=e.dragAndDropStore;Object(u.useRef)(null);var o=Object(Y.a)((function(){return{accept:_,drop:function(e){r.drop(e.id)}}})),i=Object(v.a)(o,2),a=(i[0],i[1]);return d.a.createElement("div",{ref:a,onDragOver:function(e){if(e.currentTarget){var t=e.currentTarget.getBoundingClientRect(),n=e.clientY-t.top,o=Math.floor(n/40);r.setMouseIndex(o)}},style:t,key:"".concat("6NcT","11")},n)})),$="QmNu",ee=function(e){var t=e.children,n=e.forwardRef,r=e.style;return d.a.createElement("div",{className:"VirtualScrollTree",ref:n,key:"".concat($,"11")},d.a.createElement(K,{style:r,key:"".concat($,"21")},t))},te=d.a.forwardRef((function(e,t){return d.a.createElement(ee,Object(p.a)({},e,{forwardRef:t,_nk:"iAr".concat($,"31")}))})),ne=(n(52),"C/ND"),re=function(){return d.a.createElement(R,{key:"".concat(ne,"11")})},oe={itemHeight:40},ie=Object(h.b)("entityLabelStore")(Object(h.c)((function(e){var t=e.entityLabelStore._sequence.length,n=Object(u.useMemo)((function(){return Object(m.a)(Object(m.a)({},oe),{},{itemsTotal:t})}),[t]);return d.a.createElement(X,{Container:te,options:n,key:"".concat(ne,"21")},re)}))),ae=(n(40),"F2hb"),ce=Object(h.b)("entityLabelStore")(Object(h.c)((function(e){var t=e.entityLabelStore.selected;return t.id===E?null:d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{key:"".concat(ae,"11")},d.a.createElement("strong",{key:"".concat(ae,"21")},"id:")," ",t.id),d.a.createElement("div",{key:"".concat(ae,"12")},d.a.createElement("strong",{key:"".concat(ae,"22")},"label:")," ",t.label),d.a.createElement("div",{key:"".concat(ae,"13")},d.a.createElement("strong",{key:"".concat(ae,"23")},"parentId:")," ",t.parent.id))}))),se="Z1q5",le=function(){return d.a.createElement("div",{className:"Info",key:"".concat(se,"11")},d.a.createElement(ce,{key:"".concat(se,"21")}))},pe=(n(53),"TfCB"),ue=Object(h.b)("entityLabelStore")(Object(h.c)((function(e){var t=Object(u.useCallback)((function(){e.entityLabelStore.fetch()}),[e.entityLabelStore]),n=Object(u.useCallback)((function(){e.entityLabelStore.removeSelected()}),[e.entityLabelStore]),r=Object(u.useCallback)((function(){e.entityLabelStore.apply()}),[e.entityLabelStore]);return d.a.createElement("div",{className:"Controls",key:"".concat(pe,"11")},d.a.createElement("button",{className:"Controls__button",type:"button",onClick:r,key:"".concat(pe,"21")},"Apply"),d.a.createElement("button",{className:"Controls__button",type:"button",disabled:e.entityLabelStore.pending,onClick:t,key:"".concat(pe,"22")},"Refresh"),d.a.createElement("button",{className:"Controls__button",type:"button",disabled:e.entityLabelStore.selected.id===E,onClick:n,key:"".concat(pe,"23")},"Remove"))}))),de=(n(54),"gVLi"),he=function(){return d.a.createElement("div",{className:"TreeEditor",key:"".concat(de,"11")},d.a.createElement("div",{className:"TreeEditor__viewport",key:"".concat(de,"12")},d.a.createElement(ie,{key:"".concat(de,"21")}),d.a.createElement(le,{key:"".concat(de,"31")})),d.a.createElement(ue,{key:"".concat(de,"41")}))},ge=(n(55),"JVrx");var be,ye,fe,me,Oe,ve,je,ke,Se,_e,De,Ie,xe,we,Le,Ee,Ae,Pe,qe=function(){return d.a.createElement("div",{className:"App",key:"".concat(ge,"11")},d.a.createElement(he,{key:"".concat(ge,"21")}))},Ce=n(34),Me=n.n(Ce),Ne={get id(){return-1},get label(){return""},get parent(){return Ne},children:[],setParent:function(){},addChild:function(){},getBranchMembers:function(){return[]},removeChild:function(e){},get level(){return 0},getData:function(){return{id:this.id,label:this.label,parentId:this.parent.id}},get path(){return[]},get isLastChild(){return!1}},He=(be=function(){function e(t){Object(F.a)(this,e),this._id=void 0,this._label=void 0,Object(G.a)(this,"_parent",ye,this),Object(G.a)(this,"_children",fe,this),this._id=t.id,this._label=t.label,this._parent=t.parent,this._children=t.children}return Object(U.a)(e,[{key:"id",get:function(){return this._id}},{key:"label",get:function(){return this._label}},{key:"parent",get:function(){return this._parent}},{key:"children",get:function(){return this._children}},{key:"level",get:function(){return this.parent.id===E?0:this.parent.level+1}},{key:"path",get:function(){var e=this.parent.path;return[].concat(Object(O.a)(e),[this.id])}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);-1!==t&&this._children.splice(t,1)}},{key:"getBranchMembers",value:function(){var e=this.children.reduce((function(e,t){return e.push.apply(e,Object(O.a)(t.getBranchMembers())),e}),[]);return[this].concat(Object(O.a)(e))}},{key:"setParent",value:function(e){this._parent=e}},{key:"addChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;-1===t?this._children.push(e):this._children.splice(t,0,e)}},{key:"getData",value:function(){return{id:this.id,label:this.label,parentId:this.parent.id}}},{key:"isLastChild",get:function(){var e=this.parent.children.length,t=this.parent.children[e-1];return e>0&&t.id===this.id}}]),e}(),ye=Object(J.a)(be.prototype,"_parent",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fe=Object(J.a)(be.prototype,"_children",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be),Te=(me=Object(V.f)("set data"),Oe=Object(V.f)("load entity labels"),ve=Object(V.f)("entity label remove selected"),je=Object(V.f)("entity label apply"),ke=function(){function e(){Object(F.a)(this,e),this.sequenceStash=void 0,Object(G.a)(this,"_selected",Se,this),Object(G.a)(this,"_sequence",_e,this),Object(G.a)(this,"_map",De,this),this._rootNode=void 0,Object(G.a)(this,"_pending",Ie,this),this._sequence=[],this._rootNode=new He({id:E,label:"",parent:Ne,children:[]}),this._map=this.createMap(),this._selected=Ne,this._pending=!1,this.sequenceStash=[],this.fetch()}return Object(U.a)(e,[{key:"createMap",value:function(){var e=new Map([[this._rootNode.id,this._rootNode]]);return V.n.map(e)}},{key:"moveSequence",value:function(e,t,n){var r=this._sequence,o=t-e,i=r.splice(e,o),a=n.index;e<n.index&&(a=n.index-o),r.splice.apply(r,[a,0].concat(Object(O.a)(i)))}},{key:"updateNestingPointers",value:function(e,t){for(var n,r=this._sequence,o=r[e],i=this._map.get(o),a=this._map.get(t.parentId),c=null,s=null,l=t.index-1;a!==s&&l>=0&&a!==(s=this._map.get(r[l]));l--)if(s.parent===a){c=s;break}c?n=a.children.indexOf(c)+1:n=0;i.parent.removeChild(i),i.setParent(a),a.addChild(i,n)}},{key:"moveNode",value:function(e,t){for(var n=this._sequence,r=n[e],o=this._map.get(r).parent.path,i=new Set(o),a=n.length,c=e+1,s=c;s<a;s++){var l=this._map.get(n[s]);if(i.has(l.parent.id)||s===a-1){c=s;break}}this.updateNestingPointers(e,t),this.moveSequence(e,c,t)}},{key:"initMap",value:function(e){var t=this;this._map=this.createMap(),e.entityLongIds.forEach((function(n,r){var o=e.labels[r],i=new He({id:n,label:o,parent:Ne,children:[]});t._map.set(n,i)}),{}),e.entityLongIds.forEach((function(n,r){var o=e.parentEntityLongIds[r],i=t._map.get(o),a=t._map.get(n);a.setParent(i),i.addChild(a)}))}},{key:"setData",value:function(e){this._selected=Ne,this._sequence=e.entityLongIds,this.initMap(e)}},{key:"setPending",value:function(e){this._pending=e}},{key:"fetch",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(Object(l.a)(Object(s.a)().mark((function e(){var t,n;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setPending(!0),e.prev=1,e.next=4,fetch("https://gist.githubusercontent.com/avydashenko/e1702c1ef26cddd006da989aa47d4f62/raw/067f7b75946baf7faf5b8afcd04c66ecf0b47486/view.json",{method:"GET"});case 4:return t=e.sent,Me()(t.ok,"EntityLabel http request failed"),e.next=8,t.json();case 8:n=e.sent,this.setData(n.entityLabelPages[0]),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:this.setPending(!1);case 16:case"end":return e.stop()}}),e,this,[[1,12]])}))))},{key:"removeSelected",value:function(){var e=this;if(this._selected!==Ne){this._selected.parent.removeChild(this._selected);var t=this._selected.getBranchMembers().map((function(e){return e.id})),n=new Set(t);this._sequence=this._sequence.filter((function(e){return!n.has(e)})),t.forEach((function(t){e._map.delete(t)})),this._selected=Ne}}},{key:"apply",value:function(){var e=this,t={},n=[this._map.get(-1)];this._sequence.forEach((function(r,o){var i=e._map.get(r);!function(e){var t=n.indexOf(e.parent);-1!==t?n=n.slice(0,t+1):n.push(e.parent)}(i),function(e){var r=e.getData();n.reduce((function(e,t){return t.id===E?e:(Me()(e[t.id],"Invalid tree structure"),e[t.id].children||(e[t.id].children={}),e[t.id].children)}),t)[r.id]=r}(i)})),console.log(t)}},{key:"setSelected",value:function(e){var t=this._map.get(e);this._selected=t}},{key:"sequence",get:function(){return this._sequence}},{key:"map",get:function(){return this._map}},{key:"selected",get:function(){return this._selected}},{key:"pending",get:function(){return this._pending}},{key:"removeSequenceItemAndStash",value:function(e){this.sequenceStash=Object(O.a)(this._sequence),this._sequence.splice(e,1)}},{key:"unstash",value:function(){this._sequence=this.sequenceStash}}]),e}(),Se=Object(J.a)(ke.prototype,"_selected",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(J.a)(ke.prototype,"_sequence",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=Object(J.a)(ke.prototype,"_map",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie=Object(J.a)(ke.prototype,"_pending",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(J.a)(ke.prototype,"initMap",[V.f],Object.getOwnPropertyDescriptor(ke.prototype,"initMap"),ke.prototype),Object(J.a)(ke.prototype,"setData",[me],Object.getOwnPropertyDescriptor(ke.prototype,"setData"),ke.prototype),Object(J.a)(ke.prototype,"setPending",[V.f],Object.getOwnPropertyDescriptor(ke.prototype,"setPending"),ke.prototype),Object(J.a)(ke.prototype,"fetch",[Oe],Object.getOwnPropertyDescriptor(ke.prototype,"fetch"),ke.prototype),Object(J.a)(ke.prototype,"removeSelected",[ve],Object.getOwnPropertyDescriptor(ke.prototype,"removeSelected"),ke.prototype),Object(J.a)(ke.prototype,"apply",[je],Object.getOwnPropertyDescriptor(ke.prototype,"apply"),ke.prototype),Object(J.a)(ke.prototype,"setSelected",[V.f],Object.getOwnPropertyDescriptor(ke.prototype,"setSelected"),ke.prototype),Object(J.a)(ke.prototype,"sequence",[V.g],Object.getOwnPropertyDescriptor(ke.prototype,"sequence"),ke.prototype),Object(J.a)(ke.prototype,"map",[V.g],Object.getOwnPropertyDescriptor(ke.prototype,"map"),ke.prototype),Object(J.a)(ke.prototype,"selected",[V.g],Object.getOwnPropertyDescriptor(ke.prototype,"selected"),ke.prototype),Object(J.a)(ke.prototype,"pending",[V.g],Object.getOwnPropertyDescriptor(ke.prototype,"pending"),ke.prototype),Object(J.a)(ke.prototype,"removeSequenceItemAndStash",[V.f],Object.getOwnPropertyDescriptor(ke.prototype,"removeSequenceItemAndStash"),ke.prototype),Object(J.a)(ke.prototype,"unstash",[V.f],Object.getOwnPropertyDescriptor(ke.prototype,"unstash"),ke.prototype),ke),ze={index:-1,parentId:-1},Be=(xe=function(){function e(t){Object(F.a)(this,e),Object(G.a)(this,"entityLabelStore",we,this),Object(G.a)(this,"_mouseIndex",Le,this),Object(G.a)(this,"dragging",Ee,this),Object(G.a)(this,"dropIntention",Ae,this),Object(G.a)(this,"_startDraggingIndex",Pe,this),this.entityLabelStore=t,this.dropIntention=ze,this._startDraggingIndex=-1}return Object(U.a)(e,[{key:"dropAccessorIndex",get:function(){return this.dragging?this._mouseIndex:-1}},{key:"startDraggingIndex",get:function(){return this.dragging?this._startDraggingIndex:-1}},{key:"onlyChildDropAllowed",get:function(){var e,t,n=null!==(e=this.entityLabelStore.sequenceStash[this.dropAccessorIndex])&&void 0!==e?e:E,r=null!==(t=this.entityLabelStore.sequenceStash[this.dropAccessorIndex-1])&&void 0!==t?t:E,o=this.entityLabelStore.map.get(r),i=this.entityLabelStore.map.get(n).parent.id===o.id&&1===o.children.length;return!!o.children.length&&!i}},{key:"dropIndexByUpperItemLastChild",get:function(){var e,t,n,r,o=null!==(e=this.entityLabelStore._sequence[this.dropAccessorIndex-1])&&void 0!==e?e:E;if(o===E)return-1;for(var i=null!==(t=this.entityLabelStore.sequenceStash[this.dropAccessorIndex])&&void 0!==t?t:E,a=null!==(n=this.entityLabelStore.map.get(i))&&void 0!==n?n:Ne,c=(null!==(r=this.entityLabelStore.map.get(o))&&void 0!==r?r:Ne).path.reverse(),s=-2,l=0;l<c.length;l++){var p=this.entityLabelStore.map.get(c[l]),u=0===l&&a.isLastChild&&p.parent.id===a.parent.id;if(!p.isLastChild&&!u)break;s-=1}return s}},{key:"availableDropItemIndex",get:function(){return this.onlyChildDropAllowed?-1:this.dropIndexByUpperItemLastChild}},{key:"isAbleDrop",get:function(){if(-1!==this.dropAccessorIndex&&-1!==this._startDraggingIndex){var e,t=this.entityLabelStore.sequenceStash[this._startDraggingIndex],n=null!==(e=this.entityLabelStore._sequence[this.dropAccessorIndex-1])&&void 0!==e?e:E,r=this.entityLabelStore.map.get(n);return!new Set(r.path).has(t)}return!1}},{key:"setDropIntention",value:function(e){this.dropIntention=e}},{key:"setMouseIndex",value:function(e){this._mouseIndex=e}},{key:"startDragging",value:function(e){this._startDraggingIndex=e,this.entityLabelStore.removeSequenceItemAndStash(e),this.dragging=!0}},{key:"endDragging",value:function(){this.dragging&&(this.entityLabelStore.unstash(),this.dragging=!1)}},{key:"drop",value:function(e){var t=this.entityLabelStore.sequenceStash.indexOf(e),n=this.isAbleDrop;if(this.dragging=!1,this.entityLabelStore.unstash(),-1!==this.dropIntention.index&&n&&-1!==t){var r={parentId:this.dropIntention.parentId,index:this.dropIntention.index};if(t<r.index){r.index=r.index+1}this.entityLabelStore.moveNode(t,r)}}},{key:"mouseIndex",get:function(){return this._mouseIndex}}]),e}(),we=Object(J.a)(xe.prototype,"entityLabelStore",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=Object(J.a)(xe.prototype,"_mouseIndex",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ee=Object(J.a)(xe.prototype,"dragging",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ae=Object(J.a)(xe.prototype,"dropIntention",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pe=Object(J.a)(xe.prototype,"_startDraggingIndex",[V.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(J.a)(xe.prototype,"dropAccessorIndex",[V.g],Object.getOwnPropertyDescriptor(xe.prototype,"dropAccessorIndex"),xe.prototype),Object(J.a)(xe.prototype,"startDraggingIndex",[V.g],Object.getOwnPropertyDescriptor(xe.prototype,"startDraggingIndex"),xe.prototype),Object(J.a)(xe.prototype,"onlyChildDropAllowed",[V.g],Object.getOwnPropertyDescriptor(xe.prototype,"onlyChildDropAllowed"),xe.prototype),Object(J.a)(xe.prototype,"dropIndexByUpperItemLastChild",[V.g],Object.getOwnPropertyDescriptor(xe.prototype,"dropIndexByUpperItemLastChild"),xe.prototype),Object(J.a)(xe.prototype,"availableDropItemIndex",[V.g],Object.getOwnPropertyDescriptor(xe.prototype,"availableDropItemIndex"),xe.prototype),Object(J.a)(xe.prototype,"isAbleDrop",[V.g],Object.getOwnPropertyDescriptor(xe.prototype,"isAbleDrop"),xe.prototype),Object(J.a)(xe.prototype,"setDropIntention",[V.f],Object.getOwnPropertyDescriptor(xe.prototype,"setDropIntention"),xe.prototype),Object(J.a)(xe.prototype,"setMouseIndex",[V.f],Object.getOwnPropertyDescriptor(xe.prototype,"setMouseIndex"),xe.prototype),Object(J.a)(xe.prototype,"startDragging",[V.f],Object.getOwnPropertyDescriptor(xe.prototype,"startDragging"),xe.prototype),Object(J.a)(xe.prototype,"endDragging",[V.f],Object.getOwnPropertyDescriptor(xe.prototype,"endDragging"),xe.prototype),Object(J.a)(xe.prototype,"drop",[V.f],Object.getOwnPropertyDescriptor(xe.prototype,"drop"),xe.prototype),Object(J.a)(xe.prototype,"mouseIndex",[V.g],Object.getOwnPropertyDescriptor(xe.prototype,"mouseIndex"),xe.prototype),xe),Re=new Te,Ge={entityLabelStore:Re,dragAndDropStore:new Be(Re)},Fe="kxFg";f.a.render(d.a.createElement(d.a.StrictMode,{key:"".concat(Fe,"11")},d.a.createElement(g.a,{backend:b.a,key:"".concat(Fe,"21")},d.a.createElement(h.a,Object(p.a)({},Ge,{key:"".concat(Fe,"31")}),d.a.createElement(qe,{key:"".concat(Fe,"41")})))),document.getElementById("root"));var Ue=function(){var e=Object(l.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve("f1"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Je=function(){var e=Object(l.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("1"),queueMicrotask((function(){console.log("queueMicrotask")})),e.next=4,Ue();case 4:return console.log("2"),e.next=7,Ue();case 7:console.log("3");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ve=function(){for(var e=0;e<1e6;e++)setTimeout((function(){console.log("timeout")}),0)},Ze=function(){var e=Object(l.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("f3!"),queueMicrotask((function(){console.log("queueMicrotask f3!")})),Ve(),e.next=5,Je();case 5:console.log("f3! after"),queueMicrotask((function(){console.log("queueMicrotask f3! after")}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Ze()}},[[57,1,2]]]);
//# sourceMappingURL=main.941d79c6.chunk.js.map