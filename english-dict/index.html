<!DOCTYPE html>
<html lang="ru">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <title>Словарь </title>
</head>
<body>

<div id="root">

</div>

<script src="./data.js" type="text/javascript"></script>
<script type="text/javascript">
  /*
    function download2(filename, text) {
      var iframe;
      iframe = document.getElementById("hiddenDownloader");
      if (iframe == null) {
        iframe = document.createElement('iframe');
        iframe.id = "hiddenDownloader";
        iframe.style.visibility = 'hidden';
        document.body.appendChild(iframe);
      }
      iframe.src = filename;
    }
     */

  (() => {
    function download(filename, url) {
      var element = document.createElement('a');
      element.setAttribute('href', url);
      element.setAttribute('download', filename);
      element.setAttribute('target', "_blank");
      element.style.display = 'none';
      document.body.appendChild(element);
      element.click();
      document.body.removeChild(element);
    }

    function leadingZero(num) {
      return `0000000000${num}`.slice(-5)
    }

    function downloadNext(index) {
      if (index >= data1.urls.length) {
        console.log("FINISHED!!!")
        return
      }

      if (data1.urls[index].trim()) {
        download(`${leadingZero(index)}.mp3`, data1.urls[index].trim())
      }

      setTimeout(() => {
        downloadNext(index + 1)
      }, 250)
    }

    downloadNext(0)

  })()

</script>

</body>
</html>
